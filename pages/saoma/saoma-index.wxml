<!--pages/saoma/saoma-index.wxml-->

<view wx:if="{{showErrModal}}" class="overlay">
  <view  catchtap="tabModal" class='overlay-map'></view>
  <view class="overlay-content">
    <view class="overlay-body">
      <block wx:if="{{input}}">
        <text>请输入商品的条形码</text>
        <input type='number' class='overlay-input' bindinput='bindInput' bindconfirm="tabConfirm" placeholder="请输入商品条形码" auto-focus/>
        <button bindtap="tabConfirm" class="overlay-bottom-button btn-yellow">确定</button>
      </block>
      <block wx:else>
        <image class="modal-image" src="{{errModalConfig.image? errModalConfig.image:'../../image/error.png'}}" mode="widthFix" />
        <text wx:if="{{errModalConfig.title}}" class="modal-secondText">{{errModalConfig.title}}</text>
      </block>
    </view>
  </view>
</view>
<import src="../template/count-down.wxml" />
<view wx:if="{{false}}" class="full-reduce">
  <text class="full-rec-text">满减</text>
  <text class="full-rec-tedetail">dkdkdds.ffssf分级阅读等多个机构</text>
  <text class="full-rec-mer">去凑单</text>
  <text class="full-rec-lar">></text>
</view>
<view class="page-list">
  <view class="shop df" wx:for="{{productData}}" wx:key="{{index}}">
    <image class="sh_slt" src="{{item.ImgUrl}}"></image>
    <view class="df_1">
      <view class="sp_text">
        <navigator url="../index/detail?productId={{item.ProID}}">
          <view class="sp_tit ovh1">{{item.ProductName}}</view>
        </navigator>
        <view class="sp_neb">数量：×{{item.BuyCount}}</view>
        <view class="sp_jg">¥：{{item.Price}}</view>
        <button class="dle" data-card-id="{{item.CartID}}" bindtap="removeShopCard" data-index="{{index}}">删除</button>
        <navigator class="dle" url="../order/pay?productId={{item.ProID}}&cartId={{item.CartID}}&buyCount={{item.BuyCount}}">下单 </navigator>
      </view>
    </view>
  </view>
  <!--样式-->
  <view class="container carts-list" wx:if='{{hasShop==0}}'>
    <!--  切换门店区域 -->
    <navigator url="../store/store-list?check=true" class='shop-area'>
      <view>
        <image class='address-image' src='../../image/address.png'></image>
        <text>{{locationTip}}</text>
      </view>
      <image class='address-go-image' src='../../image/address-go.png'></image>
    </navigator>
    <!--  切换门店区域结束 -->
    <view class="pp">
      <image class='pp-null' src='../../image/saoma-icon.png'></image>
      <text class='pp-text'>还没有加入商品，快去门店扫描商品吧</text>
      <button class='pp-goindex' bindtap='inputBarcode'>手动输入条码</button>
    </view>
  </view>
  <view class="container carts-list" wx:elif='{{hasShop > 0}}'>
    <!--  领券区域 -->
    <navigator class='discount shop-area' url="./coupon-list?productId=">
      <view class='discount-left'>
        <text class='discount-text'>领券</text>
        <view class='discount-imglist' wx:for="{{coupon_value}}">
          <view class='discount-img1'>￥{{item}}</view>
        </view>
      </view>
      <image class='address-go-image' src='../../image/address-go.png'></image>
    </navigator>
    <!--  领券区域结束 -->
    <!--勾-->
    <view wx:for="{{cart_list}}" class="carts-item" data-title="{{item.name}}" id="{{item.product_id}}" wx:key="{{index}}">
      <!--选中  -->
      <icon wx:if="{{item.selected}}" type="success_circle" size="20" bindtap="bindCheckbox" data-cardid='{{item.pigcms_id}}' data-index="{{index}}" />
      <!--未选中  -->
      <icon wx:else type="circle" size="20" bindtap="bindCheckbox" data-cardid='{{item.pigcms_id}}' data-index="{{index}}" />
      <!--img-->
      <view>
        <image class="carts-image" src="{{item.image}}" mode="aspectFill" />
      </view>
      <view class="cart-total">
        <text class="cart-tot-title">{{item.name}}</text>
        <view class="cart-size-list">
          <view>

            <text class='cart-text-list' wx:if="{{item.sku_data.length > 0}}" wx:for="{{item.sku_data}}" wx:for-item="item2">{{item2.name}}:{{item2.value}} </text>
          </view>
          <image class="cart-img-list" src="../../image/delete.png" bindtap="removeShopCard" data-uid='{{uid}}' data-card-id='{{item.pigcms_id}}' data-store-id='{{store_id}}' data-index='{{index}}'></image>
        </view>
        <view class="cart-frice-list-far">
          <text class="cart-frice-list">￥{{item.price}}</text>
          <view class="cart-add-reduce">
            <text class="cart-reduce cart-common" bindtap="bindMinus" data-card-id='{{item.pigcms_id}}' data-uid='{{uid}}' data-product-id='{{item.product_id}}' data-sku-id='{{item.sku_id}}' data-number='{{item.pro_num}}' data-index="{{index}}">-</text>
            <text class="cart-text-num cart-common-two" type="number" bindchange="bindManual">{{item.pro_num}}</text>
            <text class="cart-add cart-common" bindtap="bindPlus" data-card-id='{{item.pigcms_id}}' data-uid='{{uid}}' data-product-id='{{item.product_id}}' data-sku-id='{{item.sku_id}}' data-number='{{item.pro_num}}' data-index="{{index}}">+</text>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
<!--底部-->
<view class="carts-footer">
  <view class="total-choose" bindtap="scanCode">
    <image class="cart-img-list" src="../../image/saoma-code.png" lazy-load='true'></image>
  </view>
  <view class="total-price">
    <text class="total-pri-text">合计: ￥{{total}}
      </text>
  </view>
  <view class="button {{cartSHow ? 'yellow':'gray'}}" bindtap='bindCheckout'>去结算</view>
</view>